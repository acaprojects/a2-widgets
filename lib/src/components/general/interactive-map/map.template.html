<div [class]="'map ' + id" widget (window:resize)="initMap(true)">

    <div #container class="map-container" map-input [lock]="focus?.lock" [(scale)]="zoom" (scaleChange)="update(true)"
        [(center)]="center" (centerChange)="update(true)" (event)="userEvent($event)">

        <div #map class="map-area" [class.show]="!model.loading && model.show" 
            [style.transform]="model.transform | safestyle" [style.display]="model.loading ? 'none' : ''"
            [style.width]="'100%'" [style.height]="(100 * model.h_ratio) + '%'"
            [class.zooming]="model.zooming">

            <div #img class="map-img" [style.transform]="'translate(-50%, -50%) scale(' + model.zoom_level / 400 +')' | safestyle" [innerHTML]="(model.map || '') | safe">
            </div>
            <!--div class="input-area"
                map-input [(scale)]="zoom" (scaleChange)="update(true)"
                [(center)]="center" (centerChange)="update(true)"
                (event)="userEvent($event)">
            </div-->
            <map-overlay-container #overlay [model]="interest_points" [el]="model.map_el" [state]="{ center: center, scale: (100 + zoom) / 100, ratio: ratio.map }"
                [resize]="zoom + model.map_id" (event)="overlayEvent($event)" (idChange)="model.container_id = $event">
            </map-overlay-container>
        </div>
        <div class="no-map" *ngIf="!model.map && !model.loading && model.show">No map loaded!</div>
        <div class="loading-spinner" *ngIf="model.loading || !model.show">
            <spinner type="circle-ring"></spinner>
        </div>
    </div>
</div>